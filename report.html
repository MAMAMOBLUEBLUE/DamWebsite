<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reports - Lost Books</title>
  <style>
    :root{ --orange:#ff6600; --bg1:#fff5e6; --bg2:#ff9933 }
    body{ margin:0; font-family:Arial, Helvetica, sans-serif; background:linear-gradient(135deg,var(--bg1),var(--bg2)); padding:20px }
    h1{ margin:0 0 12px; font-size:28px }
    .card{ background:rgba(255,255,255,.95); padding:14px; border-radius:12px }
    table{ width:100%; border-collapse:collapse; margin-top:10px }
    th,td{ padding:10px; border-bottom:1px solid #ddd }
    th{ background:var(--orange); color:#fff }
  </style>
</head>
<body>
  <h1>Lost Books Report</h1>
  <div class="card">
    <table id="reportTable">
      <thead><tr><th>Book Title</th><th>Student</th><th>Student No</th><th>Date</th><th>Transaction ID</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
  <div style="margin-top:12px"><a href="transactions.html">Back to Transactions</a></div>

  <script>
    function readStorage(k){ return JSON.parse(localStorage.getItem(k)||'[]') }

    const books = readStorage('books'), transactions = readStorage('transactions'), students = readStorage('students')
    const lostTx = transactions.filter(t => t.type === 'lost').sort((a,b)=> new Date(b.date) - new Date(a.date))
    const tbody = document.querySelector('#reportTable tbody')
    if(lostTx.length===0) tbody.innerHTML = '<tr><td colspan="5">No lost books reported</td></tr>'
    lostTx.forEach(tx=>{
      const book = books.find(b=>b.id===tx.bookId) || { title: 'Unknown' }
      const student = students.find(s=>s.studentNumber === tx.studentNumber) || { studentName:'Unknown' }
      const tr = document.createElement('tr')
      tr.innerHTML = `<td>${book.title}</td><td>${student.studentName}</td><td>${tx.studentNumber}</td><td>${new Date(tx.date).toLocaleString()}</td><td>${tx.id}</td>`
      tbody.appendChild(tr)
    })
  </script>
</body>
</html>
